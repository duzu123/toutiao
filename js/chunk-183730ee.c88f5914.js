(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-183730ee"],{"0a38":function(t,e,n){},"230c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("van-nav-bar",{staticClass:"page-nav-bar",attrs:{"left-arrow":"",title:"黑马头条"}}),n("div",{staticClass:"main-wrap"},[t.isLoading?n("div",{staticClass:"loading-wrap"},[n("van-loading",{attrs:{color:"#3296fa",vertical:""}},[t._v("加载中")])],1):[t.article.title?n("div",{staticClass:"article-detail"},[n("h1",{staticClass:"article-title"},[t._v(t._s(t.article.title))]),n("van-cell",{staticClass:"user-info",attrs:{center:"",border:!1}},[n("van-image",{staticClass:"avatar",attrs:{slot:"icon",round:"",fit:"cover",src:t.article.aut_photo},slot:"icon"}),n("div",{staticClass:"user-name",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.article.aut_name))]),n("div",{staticClass:"publish-date",attrs:{slot:"label"},slot:"label"},[t._v(t._s(t.article.pubdate))]),n("follow-user",{attrs:{userId:t.article.aut_id},model:{value:t.article.is_followed,callback:function(e){t.$set(t.article,"is_followed",e)},expression:"article.is_followed"}})],1),n("div",{ref:"contentRef",staticClass:"article-content markdown-body",domProps:{innerHTML:t._s(t.article.content)}}),n("van-divider",[t._v("正文结束")]),n("article-comment",{ref:"listRef",attrs:{source:t.article.art_id},on:{"set-total":function(e){t.totalComment=e}}})],1):[404===t.errorStatus?n("div",{staticClass:"error-wrap"},[n("van-icon",{attrs:{name:"failure"}}),n("p",{staticClass:"text"},[t._v("该资源不存在或已删除！")])],1):n("div",{staticClass:"error-wrap"},[n("van-icon",{attrs:{name:"failure"}}),n("p",{staticClass:"text"},[t._v("内容加载失败！")]),n("van-button",{staticClass:"retry-btn"},[t._v("点击重试")])],1)]]],2),t.article.title?n("div",{staticClass:"article-bottom"},[n("van-button",{staticClass:"comment-btn",attrs:{type:"default",round:"",size:"small"},on:{click:function(e){t.isPostShow=!0}}},[t._v("写评论")]),n("van-icon",{attrs:{name:"comment-o",info:t.totalComment,color:"#777"}}),n("collect-article",{attrs:{articleId:t.article.art_id},model:{value:t.article.is_collected,callback:function(e){t.$set(t.article,"is_collected",e)},expression:"article.is_collected"}}),n("like-article",{attrs:{articleId:t.article.art_id},model:{value:t.article.attitude,callback:function(e){t.$set(t.article,"attitude",e)},expression:"article.attitude"}}),n("van-icon",{attrs:{name:"share",color:"#777"}})],1):t._e(),n("van-popup",{attrs:{position:"bottom"},model:{value:t.isPostShow,callback:function(e){t.isPostShow=e},expression:"isPostShow"}},[n("comment-post",{attrs:{target:t.article.art_id},on:{success:t.onSuccess}})],1),n("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.isReplyShow,callback:function(e){t.isReplyShow=e},expression:"isReplyShow"}},[n("comment-reply",{attrs:{comment:t.currentComment},on:{close:function(e){t.isReplyShow=!1}}})],1)],1)},i=[],a=(n("4160"),n("a9e3"),n("159b"),n("96cf"),n("1da1")),r=n("28a2"),c=n("2423"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[t.isFollowed?n("van-button",{staticClass:"follow-btn",attrs:{round:"",size:"small"},on:{click:t.onClick}},[t._v("已关注")]):n("van-button",{staticClass:"follow-btn",attrs:{type:"info",color:"#3296fa",round:"",size:"small",icon:"plus"},on:{click:t.onClick}},[t._v("关注")])],1)},l=[],u=n("c24f"),d={name:"FollowUser",model:{prop:"isFollowed",event:"update-isFollowed"},props:{isFollowed:{type:Boolean,required:!0},userId:{type:[String,Number],required:!0}},components:{},data:function(){return{isLoading:!1}},computed:{},watch:{},methods:{onClick:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoading=!0,!t.isFollowed){e.next=9;break}return e.next=6,Object(u["b"])(t.userId);case 6:t.$emit("update-isFollowed",!1),e.next=12;break;case 9:return e.next=11,Object(u["a"])(t.userId);case 11:t.$emit("update-isFollowed",!0);case 12:t.isLoading=!1;case 13:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},f=d,m=(n("e0c9"),n("2877")),p=Object(m["a"])(f,s,l,!1,null,"02ea24b6",null),b=p.exports,v=(n("e4cb"),n("0a38"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("van-icon",{attrs:{color:1===t.value?"#e5645f":"#777",name:1===t.value?"good-job":"good-job-o"},on:{click:t.onClick}})],1)}),h=[],g={name:"LikeArticle",props:{value:{type:Number,required:!0},articleId:{type:[Number,String],required:!0}},components:{},data:function(){return{isLoading:!1}},computed:{},watch:{},methods:{onClick:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoading=!0,1!==t.value){e.next=9;break}return e.next=6,Object(c["d"])(t.articleId);case 6:t.$emit("input",0),e.next=12;break;case 9:return e.next=11,Object(c["b"])(t.articleId);case 11:t.$emit("input",1);case 12:t.isLoading=!1;case 13:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},w=g,_=(n("7821"),Object(m["a"])(w,v,h,!1,null,"73e82b0a",null)),k=_.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("van-icon",{attrs:{color:t.value?"#ffa500":"#777",name:t.value?"star":"star-o"},on:{click:t.onClick}})],1)},C=[],y={name:"CollectArticle",props:{value:Boolean,articleId:[String,Number]},components:{},data:function(){return{isLoading:!1}},computed:{},watch:{},methods:{onClick:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoading=!0,!t.value){e.next=8;break}return e.next=6,Object(c["c"])(t.articleId);case 6:e.next=10;break;case 8:return e.next=10,Object(c["a"])(t.articleId);case 10:t.isLoading=!1,t.$emit("input",!t.value);case 12:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},S=y,j=(n("62a5"),Object(m["a"])(S,x,C,!1,null,"5a978867",null)),O=j.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments"},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,e){return n("comment-item",{key:e,attrs:{item:t}})})),1),n("van-cell-group",{staticClass:"publish-wrap"},[n("van-field",{attrs:{clearable:"",placeholder:"请输入评论内容"}},[n("van-button",{attrs:{slot:"button",size:"mini",type:"info"},slot:"button"},[t._v("发布")])],1)],1)],1)},L=[],$=n("2909"),I=n("b775");function P(t){return Object(I["a"])({url:"/v1_0/comments",method:"get",params:t})}function E(t){return Object(I["a"])({method:"POST",url:"/v1_0/comment/likings",data:{target:t}})}function A(t){return Object(I["a"])({method:"DELETE",url:"/v1_0/comment/likings/".concat(t)})}function D(t){return Object(I["a"])({method:"POST",url:"/v1_0/comments",data:t})}var F=n("2b0e"),N=new F["a"],U=n("5222"),z={components:{commentItem:U["a"]},name:"ArticleComment",props:{source:[String,Number],type:{type:String,default:"a"}},data:function(){return{list:[],loading:!1,finished:!1,offset:void 0}},created:function(){var t=this;this.onLoad(),N.$on("onPostSucces",(function(e){t.list.unshift(e)}))},methods:{onLoad:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,o,i,a,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,P({type:t.type,source:t.source,offset:t.offset,limit:10});case 2:o=e.sent,i=o.data.data,a=i.list_id,r=i.results,c=i.total_count,t.offset=a,(n=t.list).push.apply(n,Object($["a"])(r)),t.$emit("set-total",c),t.loading=!1,0===r.length&&(t.finished=!0);case 12:case"end":return e.stop()}}),e)})))()}}},M=z,q=(n("bb57"),Object(m["a"])(M,R,L,!1,null,"2f3c71d3",null)),T=q.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-comment"},[n("van-field",{staticClass:"post-field",attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"50",placeholder:"优质评论将会被优先展示","show-word-limit":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),n("van-button",{attrs:{type:"primary",size:"small"},on:{click:t.onPost}},[t._v("发布")])],1)},J=[],H=(n("498a"),{name:"CommentPost",components:{},props:{target:[String,Number],articleId:[String,Number]},data:function(){return{message:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onPost:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.message.trim()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,D({target:t.target,art_id:t.articleId,content:t.message});case 4:n=e.sent,t.$toast.success("新增成功"),t.$emit("success",n.data.data.new_obj);case 7:case"end":return e.stop()}}),e)})))()}}}),G=H,K=(n("9e4a"),Object(m["a"])(G,B,J,!1,null,"10eeef7c",null)),Q=K.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("van-nav-bar",{attrs:{title:t.comment.reply_count>0?t.comment.reply_count+"条评论":"评论详情"}},[n("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$emit("close")}},slot:"left"})],1),n("comment-item",{attrs:{item:t.comment}}),n("van-cell",{attrs:{title:"全部回复"}}),n("article-comment",{ref:"listRef",attrs:{type:"c",source:t.comment.com_id}}),n("div",{staticClass:"footer"},[n("van-button",{attrs:{round:""},on:{click:function(e){t.isPostShow=!0}}},[t._v("写评论")])],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.isPostShow,callback:function(e){t.isPostShow=e},expression:"isPostShow"}},[n("comment-post",{attrs:{target:t.comment.com_id,articleId:t.articleIndex.articleId},on:{success:t.onSuccess}})],1)],1)},W=[],X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("van-cell",{attrs:{title:t.item.aut_name}},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:t.item.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.item.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(t.item.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.item.pubdate))]),n("van-button",{attrs:{size:"mini",type:"default"},on:{click:function(e){return t.articleIndex.onReplyShow(t.item)}}},[t._v("回复")])],1)]),n("van-icon",{attrs:{slot:"right-icon",color:t.item.is_liking?"red":"#323233",name:t.item.is_liking?"like":"like-o"},on:{click:t.onLike},slot:"right-icon"})],1)],1)},Y=[],Z={name:"CommentItem",props:{item:Object},inject:["articleIndex"],components:{},data:function(){return{isLoading:!1}},computed:{},watch:{},methods:{onLike:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(t.isLoading=!0,!t.item.is_liking){e.next=8;break}return e.next=6,A(t.item.com_id);case 6:e.next=10;break;case 8:return e.next=10,E(t.item.com_id);case 10:t.item.is_liking=!t.item.is_liking,t.isLoading=!1;case 12:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},tt=Z,et=(n("6441"),Object(m["a"])(tt,X,Y,!1,null,"89d2f2e6",null)),nt=et.exports,ot={name:"CommentReply",inject:["articleIndex"],props:{comment:Object},components:{CommentItem:nt,CommentPost:Q,ArticleComment:T},data:function(){return{isPostShow:!1}},computed:{},watch:{},methods:{onSuccess:function(t){this.isPostShow=!1,this.$refs.listRef.list.unshift(t)}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},it=ot,at=(n("b172"),Object(m["a"])(it,V,W,!1,null,"51ae165d",null)),rt=at.exports,ct={name:"ArticlePage",props:{articleId:{type:[Number,String],required:!0}},components:{FollowUser:b,LikeArticle:k,CollectArticle:O,ArticleComment:T,CommentPost:Q,CommentReply:rt},data:function(){return{article:{},isLoading:!0,errorStatus:"",totalComment:0,isPostShow:!1,isReplyShow:!1,currentComment:{}}},computed:{},watch:{},provide:function(){return{articleIndex:this}},methods:{onReplyShow:function(t){this.isReplyShow=!0,this.currentComment=t},onSuccess:function(t){this.isPostShow=!1,this.$refs.listRef.list.unshift(t)},getArticleDetail:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c["e"])(t.articleId);case 3:n=e.sent,t.article=n.data.data,t.isLoading=!1,console.log("this.$refs.contentRef",t.$refs.contentRef),t.$nextTick((function(){var e=[];t.$refs.contentRef.querySelectorAll("img").forEach((function(t,n){e.push(t.src),t.onclick=function(){Object(r["a"])({images:e,startPosition:n})}}))})),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),t.isLoading=!1,t.errorStatus=e.t0.response.status,console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()}},created:function(){this.getArticleDetail()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},st=ct,lt=(n("7b9c"),Object(m["a"])(st,o,i,!1,null,"2a6eae96",null));e["default"]=lt.exports},"498a":function(t,e,n){"use strict";var o=n("23e7"),i=n("58a8").trim,a=n("c8d2");o({target:"String",proto:!0,forced:a("trim")},{trim:function(){return i(this)}})},"62a5":function(t,e,n){"use strict";var o=n("f924"),i=n.n(o);i.a},6441:function(t,e,n){"use strict";var o=n("ba2f"),i=n.n(o);i.a},"659f":function(t,e,n){},7244:function(t,e,n){},7821:function(t,e,n){"use strict";var o=n("ebf9"),i=n.n(o);i.a},"7b9c":function(t,e,n){"use strict";var o=n("bb77"),i=n.n(o);i.a},9034:function(t,e,n){},"9e4a":function(t,e,n){"use strict";var o=n("ddfc"),i=n.n(o);i.a},b172:function(t,e,n){"use strict";var o=n("7244"),i=n.n(o);i.a},ba2f:function(t,e,n){},bb57:function(t,e,n){"use strict";var o=n("659f"),i=n.n(o);i.a},bb77:function(t,e,n){},c8d2:function(t,e,n){var o=n("d039"),i=n("5899"),a="​᠎";t.exports=function(t){return o((function(){return!!i[t]()||a[t]()!=a||i[t].name!==t}))}},ddfc:function(t,e,n){},e0c9:function(t,e,n){"use strict";var o=n("9034"),i=n.n(o);i.a},e4cb:function(t,e,n){},ebf9:function(t,e,n){},f924:function(t,e,n){}}]);
//# sourceMappingURL=chunk-183730ee.c88f5914.js.map