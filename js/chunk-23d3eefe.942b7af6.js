(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23d3eefe"],{"1a2f":function(e,t,n){},4574:function(e,t,n){"use strict";var a=n("ceea"),r=n.n(a);r.a},"732a":function(e,t,n){"use strict";var a=n("1a2f"),r=n.n(a);r.a},"7abe":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{staticClass:"page-nav-bar",attrs:{fixed:""}},[n("van-button",{staticClass:"search-btn",attrs:{slot:"title",icon:"search",round:"",type:"info",size:"small",to:"/search"},on:{click:function(t){return e.$router.push("/search")}},slot:"title"},[e._v("搜索")])],1),n("van-tabs",{staticClass:"channel-tabs",attrs:{animated:"",swipeable:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[e._l(e.channels,(function(e){return n("van-tab",{key:e.id,attrs:{title:e.name}},[n("article_list",{attrs:{channel:e}})],1)})),n("div",{staticClass:"placeholder",attrs:{slot:"nav-right"},slot:"nav-right"}),n("div",{staticClass:"hamburger-btn",attrs:{slot:"nav-right"},on:{click:function(t){e.showEditChannel=!0}},slot:"nav-right"},[n("i",{staticClass:"toutiao toutiao-gengduo"})])],2),n("van-popup",{style:{height:"100%"},attrs:{position:"bottom",closeable:"","close-icon-position":"top-left"},model:{value:e.showEditChannel,callback:function(t){e.showEditChannel=t},expression:"showEditChannel"}},[n("channel_edit",{attrs:{channels:e.channels,active:e.active},on:{add:function(t){return e.channels.push(t)},"update-active":e.handleUpdateActive}})],1)],1)},r=[],i=(n("96cf"),n("1da1")),s=n("b775");function c(e){return Object(s["a"])({url:"v1_0/user/channels",method:"get",data:e})}function o(){return Object(s["a"])({url:"v1_0/channels",method:"get"})}function l(e){return Object(s["a"])({url:"v1_0/user/channels",method:"put",data:e})}var u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"listRef",staticClass:"artile-list"},[n("van-pull-refresh",{attrs:{"success-duration":2e3},on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败,点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e){return n("article-item",{key:e.id,attrs:{article:e}})})),1)],1)],1)},h=[],d=n("2909"),f=n("2423"),p=n("5222"),v={components:{articleItem:p["a"]},name:"articleList",props:{channel:{type:Object,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,error:!1,timestamp:Date.now(),refreshing:!1,refreshTip:""}},activated:function(){console.log("activated"),this.$refs.listRef.scrollTop=localStorage.scrollTop||0},deactivated:function(){console.log("deactivated")},created:function(){},mounted:function(){this.$refs.listRef.onscroll=function(){localStorage.scrollTop=this.scrollTop}},methods:{onLoad:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f["f"])({channel_id:e.channel.id,timestamp:e.timestamp});case 3:a=t.sent,r=a.data.data,i=r.results,s=r.pre_timestamp,(n=e.list).push.apply(n,Object(d["a"])(i)),e.timestamp=s,e.loading=!1,null!=s&&0!==i.length||(e.finished=!0),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),e.loading=!1,e.error=!0;case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},onRefresh:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(f["f"])({channel_id:e.channel.id,timestamp:Date.now()});case 3:a=t.sent,r=a.data.data.results,(n=e.list).unshift.apply(n,Object(d["a"])(r)),e.refreshing=!1,e.refreshTip="获取数据成功",t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),e.refreshing=!1,e.refreshTip="获取数据失败,请稍后重试";case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()}}},m=v,g=(n("4574"),n("2877")),b=Object(g["a"])(m,u,h,!1,null,"49d0ff98",null),w=b.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"channel-edit"},[n("van-cell",{attrs:{title:"我的频道"}},[n("van-button",{attrs:{type:"danger",size:"small",round:"",plain:""},on:{click:function(t){e.isEdit=!e.isEdit}}},[e._v(e._s(e.isEdit?"完成":"编辑"))])],1),n("van-grid",{attrs:{gutter:6}},e._l(e.channels,(function(t,a){return n("van-grid-item",{key:a,class:{active:a===e.active},attrs:{text:t.name},on:{click:function(t){return e.handleClickMyChannel(a)}}},[e.isEdit?n("van-icon",{attrs:{slot:"icon",name:"close"},slot:"icon"}):e._e()],1)})),1),n("van-cell",{attrs:{title:"我的推荐"}}),n("van-grid",{attrs:{gutter:6}},e._l(e.recommendChannel,(function(t){return n("van-grid-item",{key:t.id,attrs:{icon:"plus",text:t.name},on:{click:function(n){return e.handleAddMyChannel(t)}}})})),1)],1)},x=[],C=(n("4de4"),n("7db0"),n("a434"),n("a9e3"),{name:"channels",props:{channels:{type:Array,required:!0},active:{type:Number,required:!0}},data:function(){return{allChannels:[],isEdit:!1}},computed:{recommendChannel:function(){var e=this;return this.allChannels.filter((function(t){var n=e.channels.find((function(e){return e.id===t.id}));return!n}))}},methods:{handleAddMyChannel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.channels.push(e),!t.$store.state.token){n.next=6;break}return n.next=4,l({channels:t.channels});case 4:n.next=7;break;case 6:localStorage.toutiao_channels=JSON.stringify(t.channels);case 7:case"end":return n.stop()}}),n)})))()},handleClickMyChannel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.isEdit?(e<=t.active&&t.$emit("update-active",t.active-1,!0),t.channels.splice(e,1)):t.$emit("update-active",e);case 1:case"end":return n.stop()}}),n)})))()}},watch:{channels:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.token){e.next=5;break}return e.next=3,l({channels:t.channels});case 3:e.next=6;break;case 5:localStorage.toutiao_channels=JSON.stringify(t.channels);case 6:case"end":return e.stop()}}),e)})))()}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:n=t.sent,e.allChannels=n.data.data.channels;case 4:case"end":return t.stop()}}),t)})))()}}),_=C,y=(n("732a"),Object(g["a"])(_,k,x,!1,null,"551c86c4",null)),O=y.exports,R={data:function(){return{active:0,channels:[],showEditChannel:!1}},components:{article_list:w,channel_edit:O},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c();case 2:if(n=t.sent,e.$store.state.token)e.channels=n.data.data.channels;else try{e.channels=JSON.parse(localStorage.toutiao_channels)}catch(a){console.log(a),e.channels=n.data.data.channels}case 4:case"end":return t.stop()}}),t)})))()},methods:{handleUpdateActive:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.active=e,this.showEditChannel=t}}},j=R,E=(n("c03b"),Object(g["a"])(j,a,r,!1,null,"59db00e9",null));t["default"]=E.exports},"7db0":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),s=n("ae40"),c="find",o=!0,l=s(c);c in[]&&Array(1)[c]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!l},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(c)},a434:function(e,t,n){"use strict";var a=n("23e7"),r=n("23cb"),i=n("a691"),s=n("50c4"),c=n("7b0b"),o=n("65f0"),l=n("8418"),u=n("1dde"),h=n("ae40"),d=u("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,v=Math.min,m=9007199254740991,g="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d||!f},{splice:function(e,t){var n,a,u,h,d,f,b=c(this),w=s(b.length),k=r(e,w),x=arguments.length;if(0===x?n=a=0:1===x?(n=0,a=w-k):(n=x-2,a=v(p(i(t),0),w-k)),w+n-a>m)throw TypeError(g);for(u=o(b,a),h=0;h<a;h++)d=k+h,d in b&&l(u,h,b[d]);if(u.length=a,n<a){for(h=k;h<w-a;h++)d=h+a,f=h+n,d in b?b[f]=b[d]:delete b[f];for(h=w;h>w-a+n;h--)delete b[h-1]}else if(n>a)for(h=w-a;h>k;h--)d=h+a-1,f=h+n-1,d in b?b[f]=b[d]:delete b[f];for(h=0;h<n;h++)b[h+k]=arguments[h+2];return b.length=w-a+n,u}})},c03b:function(e,t,n){"use strict";var a=n("e584"),r=n.n(a);r.a},ceea:function(e,t,n){},e584:function(e,t,n){}}]);
//# sourceMappingURL=chunk-23d3eefe.942b7af6.js.map